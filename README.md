# Bond_Issuer_rating_matching
(In English) This is to match rating &amp; rating meaning with bonds &amp; corresponding issuers

(In Chinese) 这个文档目的是：一是将“评级含义数据”分别与：(1)债项评级等级；(2)发债主体评级等级，这两个数据合并。二是将同一笔债券的同一时间的不同评估机构给出评级，转化在同一行的不同列。三是生成“唯一标识码”，并将评级数据对应匹配到需要跑数据的债券数据中。

## 程序“rating_combined_v1.0.py”操作说明 (Program operation instructions)
(In Chinese) 详见WORD文件"2020.07.17.债券评级信息匹配介绍及程序操作说明.doc"
### 数据准备(data preparation)

共需要准备4个数据文件：

(1) 00.需要添加评级信息的债券基本信息.xlsx。这是你需要匹配评级信息的基本债券数据表。

(2) 2019.07.26.所有发债主体评级(去重).csv。这是从Wind上下载并做了去重整理的，所有发债主体评级信息表。

(3) 2019.07.26.所有债项评级(去重).csv。这是从Wind上下载并做了去重整理的，所有债项评级信息表。

(4) 2019.07.26.信用评级定义一览.xls。这是从各评级机构的官网上手工整理的等级含义表。

### 运行程序
下载安装Python3.x版本(下载网站：https://www.anaconda.com/products/individual)。安装完毕后，打开“rating_combined_v1.0.py”程序，点击运行即可。由于是自动化的程序，所以不用再做任何操作，请耐心等待程序运行完毕即可。

### 程序结果
Python输出的结果均列在“Data_out”文件夹中。

共输出6个文档，分别是

(1) 所有债券发行主体评级及等级含义输出(同时同债券不同评级机构结果在不同行).csv。这是所有发债主体评级的评级含义对应表。

(2) 所有债项评级及等级含义输出(同时同债券不同评级机构结果在不同行).csv。这是所有债项评级的评级含义对应表。

(3) 所有债券发行主体评级及等级含义输出(唯一标识码+分评估机构).csv。这是带有评级含义的所有发债主体评级的添加“唯一标识码”且做了结构化处理的表格。

(4) 所有债项评级及等级含义输出(唯一标识码+分评估机构).csv。这是带有评级含义的所有债项评级的添加“唯一标识码”且做了结构化处理的表格。

(5) 00.需要添加评级信息的债券基本信息(分评估机构的债项+发债主体评级信息).csv。这是对应“Data_in”文件夹“00.需要添加评级信息的债券基本信息.xlsx”的，添加了评级信息之后的数据，也是本程序的最终要得到的数据。

(6) 2020.07.17.18：59.保存的整理评级含义后的历史评级结果.p。这是记录Python程序所有运行结果的二进制Pickle文件，目的是保存程序结果，方便以后直接调用数据。
